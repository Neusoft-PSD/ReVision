function XYproj = Projections_circle(XY,params)
%
% Computing the nearest circle points to a set of input points
%
% Input: XY(n,2) is the array of coordinates of n points x(i)=XY(i,1), y(i)=XY(i,2)
%        params is the vector of the circle parameters
%          params = [x_c, y_c, r]
%

    % Compute nearest circle point for each point
    XYdist = XY-repmat([params(1) params(2)], [size(XY,1) 1]);
    XYproj = repmat([params(1) params(2)], [size(XY,1) 1])+...
             ((XYdist./repmat(sqrt(sum(XYdist.^2,2)),[1 2]))*params(3));

end   % Projections_circle
